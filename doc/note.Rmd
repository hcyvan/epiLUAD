---
title: "note"
author: "navych"
date: "2022/9/22"
output: html_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir = '..')
```
## Generate TSS signal Matrix
```{bash}
python .\script\methTssSignalMatrix.py -t .\data\intermediate\center.tss.bed -i .\data\external\LAD.group.ratio.bed -u 15000 -d 15000 -o .\data\intermediate\signalRoundTssMatrixGroup.bed
python .\script\methTssSignalMatrix.py -t .\data\intermediate\center.cgi.bed -i .\data\external\LAD.group.ratio.bed -u 15000 -d 15000 -o .\data\intermediate\signalRoundCgiMatrixGroup.bed
```
## Find SR-DMRs from SR-DMCs
```{r}
setwd('..')
system("python ./script/dmc2dmr.py -i ./data/intermediate/srdmc.s2.bed -o ./data/intermediate/srdmr.s2.bed")

```
## Get the Methylation Level of SR-DMC and SR-DMR
```{bash}

python ./script/methMatrixExtract.py -b /path/to/merge_ratio_bed.gz -r ./data/intermediate/srdmc.s2.bed -o ./data/intermediate/srdmc.s2.ratio.bed
python ./script/methMatrixExtract.py -b /path/to/merge_ratio_bed.gz -r ./data/intermediate/srdmr.s2.bed -o ./data/intermediate/srdmr.s2.ratio.bed
```

# Supplementary
## Genomic element annotation
The annotation of GpG islands (CGI) is download from [UCSC Table Browser](https://genome.ucsc.edu/cgi-bin/hgTables?hgsid=1773909416_i3FB69HY3DMQvl1e7YgCNw7Iqc3r).
Other genomic regions are generated by script ./R/genomeAnnotation.R

## Get SR-DMR for SR-DMC
```{bash}
python ./script/dmc2dmr.py -i ./data/intermediate/srdmc.s2.bed -o ./data/intermediate/srdmr.s2.bed
```
## Great
[Great](https://great.stanford.edu/great/public/html/) was used to do enrichment analysis for SR-DMR and DAR regions